<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #wrapper{
            width:1000px;
            height:700px;
            background: yellow;
            margin: auto;
        }
        #leftSide{
            width:150px;
            height:100%;
            background: lawngreen;
            float: left;
        }
        #leftSide select, #leftSide button{
            width:98%;
            margin-top:5px;
        }
        #leftSide img{
            width:98%;
            height:100px;
            margin-top: 5px;
        }
        textarea{
            width:95%;
            height:150px;
            margin-top: 5px;
        }
        #center{
            width:700px;
            height:100%;
            background: darkcyan;
            float:left;
        }
        #header{
            width:100%;
            height:50px;
            background: skyblue;
            text-align: center;
            font-size:28px;
        }
        #dayTitle{
            width:100%;
            height:50px;
            background: antiquewhite;
        }
        #content{
            width:100%;
            height:600px;
            background: pink;
        }
        #rightSide{
            width:150px;
            height:100%;
            background: salmon;
            float:left;
        }
        #rightSide select,#rightSide button{
            width:98%;
            margin-top:5px;
        }        
        #rightSide img{
            width:98%;
            height:100px;
            margin-top: 5px;
        }    
    </style>
    <script>
        let sel_yy, sel_mm, sel_dd, sel_icon, pic, detail1; //좌측 입력 컴포넌트들
        let sel_yy2, sel_mm2, sel_dd2, sel_icon2, pic2, detail2; //우측 입력컴포넌트들
        let title;

        let iconArray=[
            "./images/pin.png",
            "./images/pencil.png",
            "./images/drug.png"
        ];
        let nowDate; //달력에 사용될 공유 날짜 객체 
        //이 객체는 다음, 이전 버튼에 의해 변화된 날짜를 적용할것이며
        //이 날짜는 공유될 예정..

        //select 박스에 날짜 채워넣기
        //select_yy 매개변수 - 연도 출력 대상 select박스의 id를 넘기면 됨
        function initSel(select_yy, select_mm, select_icon){
            //연도에 옵션들 채우기 
            for(let i=2020;i<=2030;i++){
                let op=document.createElement("option");
                op.text=i; //사용자게 보게될 디자인 
                op.value=i;//실제 값
                select_yy.add(op); //sel_yy라는 select 박스에 자식으로 추가 
            }

            //월 채우기 
            for(let i=1;i<=12;i++){
                let op=document.createElement("option");
                op.text=i; //사용자게 보게될 디자인 
                op.value=i;//실제 값
                select_mm.add(op); //sel_yy라는 select 박스에 자식으로 추가 
            }

            //아이콘 채우기 
            for(let i=0;i<iconArray.length;i++){
                let op=document.createElement("option");
                op.text=iconArray[i];
                op.value=iconArray[i];
                select_icon.add(op);
            }
        }

        //이미지 미리보기
        function preview(photo , src){
            photo.src=src;//사용자가 선택한 option의 값
        }

        //유저가 월을 선택하면, 해당 월에 소속된 날짜를 생성하여 
        //select박스에 동적으로 부착!!
        //주의) 사용자가 값을 변경할때마다, 기존의  select박스에 채워
        //져 있떤 option이 있다면 모두 제거 후 추가!!
        function dropDate(){
            //옵션을 모두 삭제할때, 주의할 점
            //배열을 지워나가면서 반복문 내에 배열의 길이를 사용하게
            //되면 위험하다.. 길이가 동적으로 변하므로...
            let n=sel_dd.options.length;

            for(let i=0;i<n;i++){
                sel_dd.remove(1);    
            };
        }

        //사용자가 선택한 월을 넘겨받자
        function createDate(month){
            //사용자가 선택한 월을 이용하여, nowDate변경한다
            //즉 현재 날짜를 변경해준다... 
            nowDate.setMonth(month-1);
            setTitle();

            dropDate();//싹~~ 비우고

            //비워진 날짜 select박스에는, 실제 사용자가 선택한 월을
            //구성하는 총 날짜수를 구하여 채워넣자    
            let totalDate=getLastDateOfMonth();

            for(let i=1;i<=totalDate;i++){
                let op=document.createElement("option");
                op.text=i;
                op.value=i;
                sel_dd.add(op);
            }
        }

        //날짜 제목출력하기  2023년 05월
        function setTitle(){
            let yy=nowDate.getFullYear(); //년
            let mm=nowDate.getMonth();//월 0부터~~

            //월을 화면에 출력할때는 반드시 1 을 더하자
            title.innerText=yy+"년 "+(mm+1)+"월";
        }

        //현재 유저가 보고 있는 월에 소속된 날짜 수 구하기 
        //1월: 31일까지..
        function getLastDateOfMonth(){
            //날짜를 조작한다
            let d = new Date(nowDate.getFullYear(), nowDate.getMonth()+1, 0);  

            //조작된 날짜 객체에게 몇일인지 물어본다 
            return d.getDate();    
        }

        function init(){
            sel_yy=document.getElementById("sel_yy");
            sel_mm=document.getElementById("sel_mm");
            sel_dd=document.getElementById("sel_dd");
            sel_icon=document.getElementById("sel_icon");
            pic=document.getElementById("pic");

            detail1=document.getElementById("detail1");
            sel_yy2=document.getElementById("sel_yy2");
            sel_mm2=document.getElementById("sel_mm2");
            sel_dd2=document.getElementById("sel_dd2");
            sel_icon2=document.getElementById("sel_icon2");
            pic2=document.getElementById("pic2");
            detail2=document.getElementById("detail2");
            
            title=document.getElementById("title");//년,월 제목



            initSel(sel_yy, sel_mm, sel_icon); //좌측 영역의  select 들 채우기 
            initSel(sel_yy2, sel_mm2, sel_icon2); //우측 영역의  select 들 채우기 
        }

        addEventListener("load", function(){
            init();
            nowDate=new Date();
            setTitle();
        });
    </script>
</head>
<body>
    <div id="wrapper">
        <div id="leftSide">
            <select id="sel_yy">
                <option value="">년도</option>                
            </select>
            <select id="sel_mm" onChange="createDate(this.value);">
                <option value="">월</option>
            </select>
            <select id="sel_dd">
                <option value="">일</option>
            </select>

            <select id="sel_icon" onChange="preview(pic, this.value)">
                <option value="">아이콘</option>
            </select>

            <img id="pic">

            <textarea cols="13" rows="7" id="detail1"></textarea>

            <button>등록</button>

        </div>

        <div id="center">
            <div id="header">
                <button>◀</button>
                <span id="title">2023-09</span>
                <button>▶</button>
            </div>
            <div id="dayTitle"></div>
            <div id="content"></div>
        </div>


        <div id="rightSide">
            <select id="sel_yy2">
                <option value="">년도</option>
            </select>
            <select id="sel_mm2">
                <option value="">월</option>
            </select>
            <select id="sel_dd2">
                <option value="">일</option>
            </select>

            <select id="sel_icon2" onChange="preview(pic2, this.value)">
                <option value="">아이콘</option>
            </select>

            <img id="pic2">

            <textarea cols="13" rows="7" id="detail2"></textarea>

            <button>수정</button>
            <button>삭제</button>

        </div>
    </div>

</body>
</html>